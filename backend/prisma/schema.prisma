generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Utilisateur {
  id         Int      @id @default(autoincrement())
  nom        String
  prenom     String
  email      String   @unique
  motdepasse String
  role       String   @default("utilisateur")
  createdAt  DateTime @default(now())

  commandes Commande[]
}

model Administrateur {
  id         Int    @id @default(autoincrement())
  nom        String
  email      String @unique
  motdepasse String
}

model Offre {
  id          Int      @id @default(autoincrement())
  type        String
  description String
  prix        Float
  createdAt   DateTime @default(now())

  commandes Commande[]
}

model Commande {
  id        Int      @id @default(autoincrement())
  cleAchat  String   @unique
  statut    String   @default("en cours")
  total     Float
  dateAchat DateTime @default(now())

  idUtilisateur Int
  utilisateur   Utilisateur @relation(fields: [idUtilisateur], references: [id])

  idOffre Int
  offre   Offre @relation(fields: [idOffre], references: [id])

  paiement Paiement?
  billet   Billet?
}

model Paiement {
  id             Int      @id @default(autoincrement())
  paiementIntent String?
  montant        Float
  statut         String
  methode        String
  idCommande     Int      @unique
  commande       Commande @relation(fields: [idCommande], references: [id])
}

model Billet {
  id        Int     @id @default(autoincrement())
  cleBillet String  @unique
  qrCodeUrl String? @db.Text
  utilise   Boolean @default(false)

  idCommande Int      @unique
  commande   Commande @relation(fields: [idCommande], references: [id])
}
